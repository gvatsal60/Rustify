name: Rust Build, Test, and Publish

on:
  push:
    branches: [ "master", "main" ]
  pull_request:
    branches: [ "master", "main" ]

env:
  CARGO_TERM_COLOR: always

jobs:
  build:
    name: Build and Test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Build
        run: cargo build --verbose
      - name: Run tests
        run: cargo test --verbose
  
# release:
#   name: Release
#   runs-on: ubuntu-latest
#   needs: build
#   steps:
#     - uses: actions/checkout@v4
#     - name: Release Build
#       run: cargo build --release 
#     - name: Archive artifact
#       uses: actions/upload-artifact@v4
#       with:
#         name: rustify
#         path: target/release
#     - name: Create Release
#       id: create_release
#       uses: actions/create-release@v1
#       env:
#         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#       with:
#         tag_name: v${{ github.run_number }}
#         release_name: Release ${{ github.run_number }}
#         draft: false
#         prerelease: false
#     - name: Upload Release Asset
#       id: upload-release-asset
#       uses: actions/upload-release-asset@v1
#       env:
#         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#       with:
#         upload_url: ${{ steps.create_release.outputs.upload_url }}
#         asset_path: target/release
#         asset_name: rustify
#         asset_content_type: application/octet-stream